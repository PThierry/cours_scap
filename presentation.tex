\documentclass[biblatex,glossaries,usenames,dvipsnames]{Packages/beamerLACSC} %,handout
\usepackage[latin1]{inputenc}
\usepackage{amsfonts}					% special fonts support (math, etc)
\usepackage[table]{xcolor}
%\usepackage[dvipsnames]{color}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{pdftricks}
\usepackage{hyperref}					% allow interal links
\usepackage{makeidx}
\begin{psinputs}
  \usepackage{graphicx}
  \usepackage{pstricks}
  \usepackage{pstricks-add}
  \usepackage{multido}
  \usepackage{epsfig}
  \usepackage{pst-grad} % For gradients
  \usepackage{pst-plot} % For axes
  \usepackage{pst-tree} % For trees
  \usepackage{pst-3d} % For three dimensionnal graph
\end{psinputs}

\addto\captionsenglish{% Replace "english" with the language you use
  \renewcommand{\contentsname}%
    {Whatever}%
}

\newcommand{\beginbackup}{
   \newcounter{framenumbervorappendix}
   \setcounter{framenumbervorappendix}{\value{framenumber}}
}
\newcommand{\backupend}{
   \addtocounter{framenumbervorappendix}{-\value{framenumber}}
   \addtocounter{framenumber}{\value{framenumbervorappendix}} 
}


\input{Packages/Preambule}
\newcommand\juryPhotoScaleHeight{0.18}% change here the opacity level
\newcommand\vspaceafterfigure{\vspace{-0.5cm}}% change here the opacity level
\newcommand\resultfigureheight{4cm}% change here the opacity level
\renewcommand{\emph}[1]{\textit{#1}}
\addbibresource{Bibliography/Bibliography}

% New frame title command. The title is pushed on the right and made
% italic. the double ~~ avoid the title to touch the right border of the frame
\newcommand{\ftitle}[1]{
\vspace{-7mm}
\begin{flushright}{\it #1~~}\end{flushright}
}

%% Configure lstlisting colors for C code
\definecolor{Gray}{rgb}{0.95,0.95,0.95}
\definecolor{purple}{rgb}{0.8,0,0.8}

% encapsulating alt command in order to avoid to write to times the text.
% first arg is the slide on which the red color is used, the second arg is
% the text to manage
\newcommand{\PhDmyalt}[2]{\alt<#1>{\color{red} #2}{\color{gray} #2}}

\newcommand{\myhighlight}[2]{\alt<#1>{\color{red} #2}{#2}}

\renewcommand{\frametitle}[1]{{\textbf{\color{darkblue}{#1}}}\\}

\lstset{basicstyle=\fontsize{6}{7}\selectfont\ttfamily}
% let's start...
\begin{document}

% first add frames background, using the ECE standard canvas
%\setbeamertemplate{background canvas}{\includegraphics[width=\paperwidth]{img/ece.png}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
\setcounter{framenumber}{0}
\titlepage
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% disactive title color. Frame titles will have no bg color
%\setbeamercolor{titlelike}{fg=titleTextColor,bg=white}

\begin{frame}[t]
  \frametitle{Introduction}
  \begin{itemize}
    \item Ce cours décrit l'état de l'art des outils de maintien en condition
      de sécurité ainsi que les principes généraux et le workflow des standard
      SCAP.
    \item Dans le cadre de ce cours, les outils restent orientés pour les
      cibles GNU/Linux dans l'optique des travaux pratiques mais le sujet du
      maintien en condition de sécurité est global à l'ensemble d'une
      infrastructure (appliances propriétaires, postes bureautiques, etc.).
      Les principes derrière SCAP sont conçus pour supporter l'ensemble des
      équipements logiciels ou appliances du marché.
  \end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
{\Large Sommaire}
\setcounter{tocdepth}{1}
\scriptsize \tableofcontents
\setcounter{tocdepth}{2}
\end{frame}


%\setbeamertemplate{background canvas}[vertical shading][top=blue!80,midpoint=0.8,bottom=white]
\section{MCS}
\subsection{Les principes de base}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Maintenir ses équipments à jour}
  \begin{block}{Suivi des mises à jour et des correctifs}
  \begin{itemize}
    \item Principe de base de tout système d'information
    \item Pas toujours aisé à mettre en application
      \begin{itemize}
        \item Tests de non-regression des patchs fonctionnels et de sécurité
        \item Accès aux dépôts de correctifs pas toujours direct
        \item Parfois complexe dans un système d'information hétérogène
          \begin{itemize}
            \item Imprimantes, appliances, postes bureautiques, serveurs...
          \end{itemize}
      \end{itemize}
    \item Est souvent dénoté sous l'intitulé "patch management"
  \end{itemize}
\end{block}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Appliquer les bonnes pratiques de configuration}
  \begin{block}{}
  \begin{itemize}
    \item Historiquement pas toujours présentes, aujourd'hui de plus en plus
      souvent fournies par les fournisseurs de logiciels
    \item Peuvent nécessiter une refonte de l'usage des logiciels (utilisation
      laxiste du compte administrateur, accès direct aux API internes sans
      filtrage amont, etc.)
    \item Initialement peu lisibles dans les guides de sécurité car de trop
      haut niveau (e.g. NIST SP-800-53), les bonnes pratiques de configurations
      sont apparues au fur et à mesure du temps avec les STIGs ou 
      sous forme de CCE (Common Configuration Enumeration) et dans les divers
      autres guides techniques (e.g. ANSSI DAT-NT-28, ANSSI DAT-NT-007 pour GNU/Linux)
  \end{itemize}
  \end{block}
  
  %\begin{center}
  %\includegraphics[width=0.40\paperwidth]{figures/tmobile_g1.jpg}
  %\end{center}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Définir une polique de sécurité d'un système d'information}
  \begin{block}{}
  \begin{itemize}
    \item Cette politique, nommée PSSI, est sous la responsabilité du DSSI de
      l'entreprise, et rédigée en comité avec des experts en sécurité des
      systèmes d'information
    \item Cette politique n'est valable que si elle est applicable et
      contrôlable dans le temps
    \item Une PSSI peut contenir des éléments techniques (durcissement des
      configurations par exemple) mais contient également souvent des éléments
      organisationnels (gestion des accès aux salles machines, au bâtiments,
      gestion des horaires d'accès au(x) site(s), etc.
    \item Une PSSI dépend des moyens que la société accepte de mettre dans la
      sécurité de son système d'information (au sens large), mais aussi de la
      réglementation en vigueur. En France, il existe plusieurs réglementation
      imposant un durcissement minimum à certains acteurs (typiquement les
      OIV), comme la PSSIE [p. \ref{pssie}] ou la PPST [p. \ref{ppst}]
  \end{itemize}
  \end{block}
\end{frame}


\subsection{Quelques exemples d'outils}

\defverbatim[colored]\lstdsc{
%\begin{lstlisting}[language=sh]
{\footnotesize
\begin{verbatim}
# debsecan --only-fixed
[...]
  CVE-2016-3710 qemu-system-common (fixed, high urgency)
  CVE-2016-3712 qemu-system-common (fixed, low urgency)
  CVE-2016-7966 libakonadi-kmime4 (fixed, remotely exploitable, high urgency)
  CVE-2016-6232 libkmediaplayer4 (fixed, remotely exploitable, medium urgency)
  CVE-2017-6410 libkmediaplayer4 (fixed, remotely exploitable, medium urgency)
  CVE-2017-8422 libkmediaplayer4 (fixed, high urgency)
[...]
\end{verbatim}
}
%\end{lstlisting}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
\frametitle{Recherche de vulnérabilité}
\begin{block}{debsecan}
  \begin{itemize}
    \item Outil de recherche de vulnérabilité sur un équipement donné
    \item Spécifique à la distribution Debian. A été porté sous Ubuntu mais
      sans supporter ces dernières comme cibles
    \item S'appuie sur les DSA (Debian Security Announces) de
      security.debian.org pour remonter les vulnérabilités présentes dans
      l'équipement
    \item Assure une traçabilité aux CVEs
  \end{itemize}
  \end{block}
  \lstdsc
\end{frame}

\subsubsection{Bonnes pratiques de configuration}
\defverbatim[colored]\lstlynis{
%\begin{lstlisting}[language=sh]
{\footnotesize
\begin{verbatim}
$ sudo lynis audit system
[...]
[+] Security frameworks
------------------------------------
- Checking presence AppArmor                            [ FOUND ]
  apparmor filesystem is not mounted.
  - Checking AppArmor status                            [ UNKNOWN ]
- Checking presence SELinux                             [ FOUND ]
  - Checking SELinux status                             [ DISABLED ]
- Checking presence grsecurity                          [ NOT FOUND ]
- Checking for implemented MAC frame                    [ NONE ]
[...]
Lynis security scan details:

  Hardening index : 51 [##########          ]
  Tests performed : 207
  Plugins enabled : 1
\end{verbatim}
}
%\end{lstlisting}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
\begin{block}{Bastille}
  \begin{itemize}
    \item Bastille est un vieil outil de durcissement de configuration,
      également capable de faire de l'audit et du reporting
    \item Basé sur une interface interactive pour le durcissement des
      configurations, il permet à un administrateur peu habitué à la
      sécurisation d'un OS UNIX ou GNU/Linux d'appliquer les bonnes pratiques
      de base
    \item Bien que toujours supporté, Bastille est aujourd'hui en perte de
      vitesse face à des outils comme Lynis ou OpenSCAP pour l'audit et la
      remédiation
  \end{itemize}
\end{block}
\end{frame}

\subsubsection{Traçabilité à une politique de sécurité}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \only<1>{
  \begin{block}{lynis}
  \begin{itemize}
    \item Lynis est un outil en ligne de commandes bien abouti, permettant
      d'étudier l'état des configuration et des versions des logiciels du
      système d'exploitation afin de les confronter à une politique de
      sécurité donnée, pouvant être personnalisée
    \item Le rapport de Lynis est de bonne facture et donne un bon apperçu du
      niveau de durcissement de l'OS et des manquements présents
    \item Lynis supporte un grand nombre de tests, ce qui en fait un outil
      riche et efficace, avec une synthèse très convenable
  \end{itemize}
  \end{block}
  }
  \only<2>{
    \lstlynis
  }
\end{frame}

\subsection{Les limites de cet état de l'art}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]

  \only<1-2>{
  \frametitle{Un écosystème désordonné}
  }
  \only<1>{
  \begin{itemize}
    \item Bien que les outils de patch management et de suivi de la sécurité
      d'un équipement existent, l'écosystème de gestion de la sécurité est
      longtemps resté siloté entre chaque industriel (Microsoft, IBM, etc.),
      sans véritable définition de standards unifiés permettant de gérer de
      manière homogène un système d'information
    \item Les outils de validation des politiques de sécurité ont également
      longtemps implémenté leurs propres implémentations pour valider les
      politiques standard, comme le PCI-DSS ou les exigences NIST. Ces
      implémentations, incluant souvent une validation aurpès de l'ogranisme
      éditeur de la politique, étant vue (à juste titre) comme une valeur
      ajoutée du logiciel, imposant de fait aux industriel une fidélité à un
      éditeur pour simplifier la gestion de la sécurité de leur parc
  \end{itemize}
  }
  \only<2>{
    \begin{itemize}
      \item L'existance de structures verticales multiples (en générale par
        vendeur) et incompatibles entre elles rend le gestion de la sécurité
        d'un parc quasiment impossible à valider efficacement, à la fois
        en terme de coût et en terme de garantie
      \item L'indépendances des échelles, des outils et des protocoles
        implique une mise en place difficile du plan de gestion de la
        sécurité, et un surcoût évident au niveau du SoC (Security Operation
        Center) du système d'information, écartant de fait ce service des
        petits acteurs
    \end{itemize}
  }

  \only<3>{
  \frametitle{Comment corriger le tir ?}
  \begin{itemize}
    \item Séparer l'implémentation des sondes du formalisme des tests,
      permettant d'enrichir chaque partie aisément
    \item Formaliser l'identification des éqiupements logiciels, matériels
    \item Formaliser une vulnérabilité et son écosystème (risque, complexité,
      cible, etc.)
    \item Définir un ensemble de languages pour définir, sans prendre
      d'hypothèse sur le logiciel ou matériel cible:
      \begin{itemize}
        \item une fiche de test
        \item une politique de sécurité
        \item une mécanique de correction de la faiblesse de sécurité
          (remédiation)
      \end{itemize}
    \item {\textcolor{red}{Faire en sorte de faire entrer l'ensemble des constructeurs et éditeurs
      dans le nouvel écosystème}}
  \end{itemize}
  }
\end{frame}

\subsection{La genèse de SCAP}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Petit rappel des organismes parties prenantes}
  \begin{itemize}
    \item \PhDmyalt{1}{{\bf DoD} - Department of Defense (US)}\\
      Ministère de la défense américain. Demandeur de la solution.
    \item \PhDmyalt{2}{{\bf NSA} - National Security Agency (US)}
      Agence de sécurité américaine garante de l'efficacité sécuritaire de la
      solution.
    \item \PhDmyalt{3}{{\bf DoHS} - Department of Homeland Security (US)}\\
      Ministère de l'intérieur, co-demandeur.
    \item \PhDmyalt{4}{{\bf DISA} - Defense Information System Agency (US)}\\
      Agence en charge de la sécurité des systèmes d'informations de défense,
      en charge de la rédaction de politiques de sécurité pour les SI de
      défense américains.
    \item \PhDmyalt{5}{{\bf NIST} - National Institute for Standards and
      Technologies (US)}\\
      Organisme normatif américain, en charge de rédiger et de mettre à jour
      les standards américain dans le domaine des technologies de
      l'information et de la communication.
  \end{itemize}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \begin{itemize}
    \item La création de SCAP débute au début des années 2000, sur
      une demande du DoD pour unifier les mécanismes de gestion de la
      sécurité des systèmes d'information autour d'un ensemble de standards
    \only<1>{
    \item Le but est de casser les technologies en silos de suivi de la
      sécurité pour mettre en application une solution transverse, applicable
      à l'ensemble d'un système d'information, allant des appliances réseau
      aux postes de travail, en passant par les serveurs et les équipements
      embarqués
    \item La création du standard est poussée par le DoD, la NSA, le DoHS
      et le DISA (Agence pour les systèmes d'informations de Défense). le
      standard est porté par le NIST (National Institute for Standard \&
      Technology)
    }
    \only<2>{
    \item Le NIST définit alors un ensemble de standard:
      \begin{itemize}
        \item Les {\it CVE} (Common Vulnerability Exposure), formalisant une
          vulnérabilité
        \item Les {\it CVSS} (Common Vulnerability Scoring System), associant une
          pondération à une vulnérabilité
        \item Les {\it CWE} (Common Weakness Enumeration), formalisent des
        famille de faiblesses par type (défaut de configuration, mauvais
          nettoyage des entrées logicielles, etc.)
        \item Les {\it CPE} (Common Plateform Enumeration), formalisant une
          identification des équipements
        \item {\it XCCDF} (eXtensible Checklist Configuration Description Format),
          formalisme XML permettant de définir une checklist de sécurité et de
          générer des rapports de conformité
        \item {\it OVAL} (Open Vulnerability and Assessment Language), formalisme
          XML définissant une fiche de test
      \end{itemize}
    }
    \only<3>{
      \item Les premières présentations (publiques !) de SCAP datent de 2008
      \item La version 1.0 finalisée du standard, publiée par le NIST,
        date du 27 juillet 2010
      \item Les formalismes XCCDF, OVAL possèdent leur propre cycle de vie.
        Oval en est à la version 5.11, XCCDF à la version 1.2
    }
  \end{itemize}
\end{frame}

\section{SCAP}

\subsection{Un écosystème de standards}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
   \begin{block}{Les CVEs}
   \begin{itemize}
     \item Une CVE est une formalisation d'une vulnérabilité.
     \item Une CVE est composé d'un ensemble de propriétés
   \end{itemize}
 \end{block}
   \only<1>{
     \vfill
     \vfill
     \vfill
   }
   \only<2-11>{
     {\small
    \begin{itemize}
       \item \PhDmyalt{2}{Son score CVSS (défini plus loin), conséquence des autres
         propriétés}
       \item \PhDmyalt{3}{Son impact en terme de confidentialité}
       \item \PhDmyalt{4}{Son impact en terme d'intégrité}
       \item \PhDmyalt{5}{Son impact en terme de disponibilité}
       \item \PhDmyalt{6}{Sa complexité technique de mise en oeuvre}
       \item \PhDmyalt{7}{Le niveau d'accès nécessaire à sa mise en oeuvre}
       \item \PhDmyalt{8}{Le niveau de gain}
       \item \PhDmyalt{9}{Le type de vulnérabilité}
       \item \PhDmyalt{10}{L'identifiant de faiblesse associé (CWE)}
       \item \PhDmyalt{11}{Un identifiant unique la référençant, sous la forme CVE-<année>-<incrément>}
     \end{itemize}
    }
   }
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]

\begin{center}
  \begin{figure}
    \includegraphics[height=5.5cm]{Images/scap/cve_example}
    \caption{CVE-2016-8437 (\url{http://www.cvedetails.com/cve/CVE-2016-8437/})}
  \end{figure}
\end{center}

\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Le CVSS}
  \begin{itemize}
    \item Permet de déterminer le niveau de risque associé à une CVE
    \item est basé sur une echelle de 1 (très faible) à 10 (très important)
    \item Le calcul du CVSS est basé sur:
      \begin{itemize}
        \item l'impact de l'exploitation de la vulnérabilité en terme de
          confidentialité, d'intégrité et de disponibilité de la cible
        \item La complexité technique à l'exploitation de la faille (niveau
          technique nécessaire pour l'attaquant)
        \item Les hypothèses nécessaires à l'attaque (accès local, distant,
          nombre de séquences d'authentification préalables sur la cible) 
      \end{itemize}
    \item On associe souvent à l'échelle de CVSS l'échelle risque statistique
      associé à la vulnérabilité. Elle permet de plus de fournir un tableau
      synthétique du risque moyen par vendeur et/ou composant basé sur
      l'historique des CVE associées à ce dernier
  \end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]

  \only<1>{
  \begin{center}
  \begin{figure}
  \includegraphics[height=5.5cm]{Images/scap/cvss_mswin7}
    \caption{Synthèse des impacts des vulnérabilités de Ms. Windows 7
    (\url{http://www.cvedetails.com/cvss-score-charts.php?product_id=17153&fromform=1})}
  \end{figure}
  \end{center}
  }
  \only<2>{
  \begin{center}
  \begin{figure}
  \includegraphics[height=5.5cm]{Images/scap/cvss_adobe_flash}
    \caption{Synthèse des impacts des vulnérabilités d'Adobe Flash Player
    (\url{https://www.cvedetails.com/cvss-score-charts.php?product_id=6761&fromform=1})}
  \end{figure}
  \end{center}
  }

\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Les CWE}
  \begin{itemize}
    \item Le but des CWE et de définir des familles de faiblesses (à
      différencier d'une vulnérabilité, une faiblesse n'impliquant pas
      nécessairement une vulnérabilité), pouvant s'appliquer à tout type de
      cible logicielle ou matérielle.
    \item L'usage des CWE permet de fournir un indiquateur de qualimétrie de
      sécurité de la cible selon l'état des CWE associé et selon les
      faiblesses détectées
    \item Les CWE sont organisée sous forme d'une structure hiérarchique de
      faiblesses
    \item Il existe des centaines de CWE, classées et numérotées, comme par
      e.g.:
      \begin{itemize}
        \item CWE 20: Improper Input Validation. Typiquement une validation
          incorrecte d'un flux d'entrée non maîtrisée.
        \item CWE 494: Download of code without integrity check. Exemple de
          faiblesse liée à la mise à jour logicielle non sécurisée d'une appliance
      \end{itemize}
    \item A chaque identitfant de CWE est indiqué l'impact probable d'une CVE
      basée sur celle-ci, l'effet probable en terme d'accessibilité, confidentialité
      et disponibilité, et les manières de s'en prémunir
  \end{itemize}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Les CPE}
  \begin{itemize}
    \item Qui dit formalisation généralisée à l'ensemble des équipements et
      vendeurs dit définition d'un formalisme pour identifier de manière
      unique une plateforme. C'est le rôle du dictionnaire CPE
    \item le format CPE (v2.3) définit une structure de donnée hiérarchique,
      séparée par des ':'.
      Voici sa osyntaxe:
      \begin{itemize}
        \only<1>{
          \item cpe : chaine fixe
          \item cpe-dict-release : numéro de version CPE, aujourd'hui 2.3
          \item part : type d'équipement ((a)pplication, (o)s, ou (h)ardware)
          \item vendor : non du vendeur
          \item productname : nom du produit
          \item product-version : version du produit
          \item update-version : numéro de mise à jour de la version (si
            existant)
          \item edition-version : édition interne à la numérotation de mise à
            jour (si existant)
          \item language-name : langue cible (si existant)
        }
        \only<2>{
          \item Pour Microsoft I.E, on retrouve la structure suivante:\\
            \colorbox{Cyan}{cpe:2.3:a:microsoft:internet\_explorer:8.0.6001:beta:*:*:*:*:*:*}
          \item Pour un système d'exploitation (part passe de 'a' à 'o', on aura,
            par exemple pour Debian:\\
            \colorbox{Cyan}{cpe:2.3:o:debian:debian\_linux:8.0:*:*:*:*:*:*:*}
          \item Pour un équipement matériel, hiérarchisé dans la partie
            'hardware', on aura:\\ 
            \colorbox{Cyan}{cpe:2.3:h:cisco:12000\_router:-:*:*:*:*:*:*:*}
          }
      \end{itemize}
    \item Il est possible de rédiger ses propres fiches CPE, au format OVAL,
      sans déclarer son produit auprès du MITRE.
  \end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Le formalisme OVAL}
  \begin{block}{Une fiche de test}
    \begin{itemize}
      \item Un langage verbeux, au format XML
      \item Utilisant correctement l'écosystème XML (XMLSchema, XSD, etc.)
      \item Définissant la finalité du test, pas le moyen (laissé à
        l'implémentation de la sonde)
    \end{itemize}
  \end{block}

\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Le formalisme XCCDF}
  \begin{block}{Langage de génération des STIGs et des checklists}
    \begin{itemize}
      \item Permet de rédiger des checklists (typiquement pour auditer un
        équipement par rapport à une politique de sécurité)
      \item Génère dans le même temps le guide de sécurité associé
      \item est un formalisme XML
      \item Associe un ensemble de fiches OVAL à une politique de sécurité,
        assurant ainsi une traçabilité des tests
    \end{itemize}
  \end{block}

  \begin{block}{XCCDF est riche et complexe}
    \begin{itemize}
      \item Il possède des mécanismes de contrôle intégrés (macros if)
      \item Permet d'intégrer des mécanismes d'interactivité via le formalisme
         OCIL (Open Checklist Interactive Language)
       \item Il supporte la gestion de variables pouvant être rafinées selon
         les profils associé au guide de sécurité
    \end{itemize}
  \end{block}
\end{frame}

\subsection{Un workflow complet pour le MCS}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]

  \frametitle{Petite synthèse}
  \begin{center}
    \begin{figure}
      \includegraphics[height=5.5cm]{Images/scap/scap_automaton}
      \label{scap_workflow}
      \caption{Schéma de synthèse du standard
      (\url{https://cve.mitre.org/docs/docs-2005/transformational_standards.html})}
    \end{figure}
  \end{center}

\end{frame}

\subsection{Etat de l'art des implémentations}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \only<1>{
  \begin{block}{Solutions professionelles}
    \begin{itemize}
      \item SCAP est aujourd'hui supporté par diverses outils et fournisseurs de logiciels de sécurité
        \begin{itemize}
          \item Nessus Manager, Ms Configuration Manager 2007, SAINT Security Suite, Qualys...
        \end{itemize}
       \item Bien que SCAP soit basé sur un ensemble de standards, les fiches OVAL ou les STIGs ne sont pas toujours interopérables
          \begin{itemize}
            \item Cetains éditeurs, comme CIS, enrichissent le language
            \item La compréhention de la norme peut varier selon les implémentations
        \end{itemize}
    \end{itemize}
  \end{block}
  }
  \only<2>{
  \begin{block}{Solutions Open-Source}
    \begin{itemize}
      \item A ce jour, le projet Open-Source le plus abouti est Open-SCAP, initié par le NIST
      \item Les politiques de sécurité sont portées par le projet SCAP-Security-Guide
    \end{itemize}
  \end{block}
  \begin{alertblock}{Limitations des solutions Open-Source}
    \begin{itemize}
      \item Très orientées GNU/Linux, le support des *BSD est de Windows en est à ses balbutiement
      \item Un long travail d'enrichissement des sondes est nécessaire
    \end{itemize}
  \end{alertblock}
  }
\end{frame}



%\defverbatim[colored]\lstGHBN{
%\begin{lstlisting}[language=C]
%struct hostent *gethostbyname(const char *name) {
%   printf("FIX ME! implement %s %s:%d\n", __FUNC__, __file__,__line__);
%     return NULL;
%}
%\end{lstlisting}
%}

\section{Utiliser SCAP}

\subsection{OpenSCAP et SCAP-Security-guide}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]

\only<1>{
\begin{block}{OpenSCAP}
  \begin{itemize}
    \item Implémentation en C
    \item Supporte un ensemble de sonde correspondant au diverses abstraction OVAL
    \item Chaque sonde gère une tâche particulière
      \begin{itemize}
        \item Parsing d'un fichier
        \item Intérogation d'un gestionnaire de services
        \item Intérogation d'un gestionnaire de paquets
      \end{itemize}
    \item Gère la génération de rapports aux formats HTML, XML et ARF
    \item Sait lancer des scripts de remédiation si fournis en entrée
    \item Sait traiter en entrée des données au formats OVAL ou XCCDF principalement
  \end{itemize}
\end{block}
}
\only<2>{
\begin{block}{SCAP-Security-Guide}
  \begin{itemize}
    \item Contient les politiques au format OVAL et XCCDF
    \item Se base sur un moteur de génération écrit en Python
    \item S'appuie sur OpenSCAP pour construire les STIGs et les benchmarks associés
    \item Supporte divers STIGs (PCI-DSS, Notes techniques ANSSI...)
    \item Supporte divers cibles GNU/Linux
    \item Supporte divers cibles applicatives (Chrome, JBoss, JRE...)
    \item Supporte les scripts de remédiation dans divers format
  \end{itemize}
\end{block}

\begin{alertblock}{Etat des lieux du projet}
  \begin{itemize}
    \item Toutes les distributions et applicatifs ne sont pas supportés de manière égale
    \item Un gros effort est en cours sur le support des scripts de remédiation
    \item La complétudes des STIGs n'est pas toujours complète
  \end{itemize}
\end{alertblock}
}

\end{frame}

\subsection{Tester la conformité d'une cible à une politique de sécurité}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
\end{frame}

\subsection{Appliquer des scripts de remédiation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
\end{frame}


\subsection{Gérer la sécurité d'une infrastructure}

\defverbatim[colored]\lstoscapd{
%\begin{lstlisting}[language=sh]
{\footnotesize
\begin{verbatim}
# oscapd-cli task
---+------------+-------------------------+---------------------+---------
ID | Title      | Target                  | Modified            | Enabled 
---+------------+-------------------------+---------------------+---------
1  | hebdo-t12  | my-debian-laptop        | 2017-04-13 12:44:38 | enabled

# oscapd-cli result 1
Results of Task "hebdo-t12", ID = 1

---+---------------------+-----------------
ID | Timestamp           | Status          
---+---------------------+-----------------
1  | 2017-04-13 15:51:34 | Non-Compliant
2  | 2017-04-20 11:51:29 | Non-Compliant
3  | 2017-04-27 15:51:41 | Compliant

# oscapd-cli result 1 2 arf  > exported-arf-result.xml
# oscapd-cli result 1 2 report > exported-report.html
\end{verbatim}
}
%\end{lstlisting}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Centraliser les rapports, gérer le SI}
  \only<1>{
  \begin{columns}
    \column{0.5\textwidth}

    \begin{center}
    \begin{figure}
      \includegraphics[width=0.9\linewidth]{Images/scap/foreman_compliance}
      \label{scap_foreman}
      \caption{Intégration d'OpenSCAP à Foreman
      (\url{https://www.theforeman.org/plugins/foreman_openscap/0.4/})}
    \end{figure}
    \end{center}
 
    \column{0.5\textwidth}

    \begin{center}
    \begin{figure}
      \includegraphics[width=0.9\linewidth]{Images/scap/rh_satellite_compliance}
      \label{scap_rhsatellite}
      \caption{Intégration d'OpenSCAP à Red-Hat Satellite
      (\url{https://access.redhat.com/documentation/en-us/red_hat_satellite/6.2/html-single/host_configuration_guide/})}
    \end{figure}
    \end{center}

  \end{columns}
  }
  \only<2>{
    Interface du daemon OpenSCAP:
    \lstoscapd
  }
\end{frame}



\section{Dans les arcanes du standard}

\subsection{OVAL: rédiger une fiche de test}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \begin{block}{Formalisme de base}
    \begin{itemize}
      \item Une fiche OVAL est une définition, à laquelle on associe un ou plusieurs tests
      \item Une définition peut être de type:
	      \begin{itemize}
		      \item compliance (conformité à une exigence)
		      \item inventory (détection d'un composant - au sens du standard CPE)
		      \item patch (détection de la présence d'un patch)
		      \item vulnerability (détection d'une vulnérabilité)
		      \item miscellaneous (tout le reste)
	      \end{itemize}
      \item une fiche OVAL possède un identifiant unique (dénoté {\it id}), une description, un titre et une ou plusieurs cible(s)
    \end{itemize}
  \end{block}
  \begin{block}{Critères de validation de la fiche}
    \begin{itemize}
      \item Une fiche OVAL est vraie lorsque :
	      \begin{itemize}
		      \item la cible correspond à celle définie dans la fiche OVAL
		      \item l'ensemble des critères nécessaires et suffisants à sa validation ont été joués avec un résultat positif
	      \end{itemize}
    \end{itemize}
  \end{block}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \begin{block}{Les critères OVAL}
    \begin{itemize}
      \item Les critères utilisent une logique booléenne récursive
      \item On peut utiliser la mécanique booléenne pour construire des fiches complexes
	      \begin{itemize}
		      \item Appliquant des tests différents selon la plateforme cible
		      \item Se comportant différement selon l'architecture matérielle
		      \item etc.
	      \end{itemize}
      \item Les critères permettent de hiérarchiser les fiches, une fiche pouvant enrichir (et donc dépendre) d'une autre
      \item Le sur-usage de la logique booléenne des critères peut cependant rendre la fiche illisible
    \end{itemize}
  \end{block}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \begin{block}{Les sélecteurs OVAL}
    \begin{itemize}
	    \item Des politiques de sécurités de plus haut niveau (comme celles du NIST) peuvent impliquer plusieurs STIGs
	    \item Les STIGs peuvent impliquer des niveaux de durcissement variables selon le profil
	    \item Afin de ne pas multiplier les fiches OVAL, le language permet l'usage de variables, qu'on dénote sélecteur
    \end{itemize}
  \end{block}
	\begin{block}{Ecrire une fiche avec des sélecteurs}
    \begin{itemize}
	    \item Un sélecteur est une variable dans un test
	    \item La variable est désignée par son nom, qui devra être résolu au moment de la construction de la checklist XCCDF
	    \item Une fiche OVAL paramétrée impose, pour chaque profil qui l'utilise, de spécifier le sélecteur parmis les choix possibles
	    \item Une fiche OVAL paramétrée impose, dans la checklist XCCDF, de lister exhaustivement l'ensemble des possible pour le sélecteur
    \end{itemize}
  \end{block}
\end{frame}


%\defverbatim[colored]\lstoscapd{
\defverbatim[colored]\lstoval{
\begin{lstlisting}[language=xml]
<def-group>
  <definition class="compliance" id="partition_for_tmp" version="1">
    <metadata>
        <title>Ensure /tmp Located On Separate Partition</title>
        <affected family="unix">
          <platform>Debian 8</platform>
        </affected>
        <description>
          The /tmp directory is a world-writable directory used for
          temporary file storage. Verify that it has its own partition or logical
          volume.
        </description>
    </metadata>
    <criteria>
      <criterion test_ref="test_tmp_partition" comment="/tmp on own partition" />
    </criteria>
  </definition>
  <linux:partition_test check="all" check_existence="all_exist" id="test_tmp_partition" version="1" comment="/tmp on own partition">
     <linux:object object_ref="object_own_tmp_partition" />
  </linux:partition_test>
  <linux:partition_object id="object_own_tmp_partition" version="1">
    <linux:mount_point>/tmp</linux:mount_point>
  </linux:partition_object>
</def-group>
\end{lstlisting}
}

%\defverbatim[colored]\lstoscapd{
\defverbatim[colored]\lstovald{
\begin{lstlisting}[language=xml]
<def-group>
  <definition class="compliance" id="accounts_password_pam_retry" version="1">
    <metadata>
      <title>Set Password retry Requirements</title>
      <affected family="unix">
        <platform>multi_platform_fedora</platform>
        <platform>multi_platform_rhel</platform>
        <platform>multi_platform_rhel-osp</platform>
      </affected>
      <description>The password retry should meet minimum requirements</description>
    </metadata>
    <criteria operator="OR" comment="Conditions for retry are satisfied">
      <criteria operator="AND" comment="system with pam_cracklib configured">
        <criteria operator="OR" comment="OSes with cracklib primarily used">
          <extend_definition comment="RHEL6 OS installed" definition_ref="installed_OS_is_rhel6" />
          <extend_definition comment="CentOS6 OS installed" definition_ref="installed_OS_is_centos6" />
        </criteria>
        <criterion comment="rhel6 pam_cracklib" test_ref="test_password_pam_cracklib_retry" />
      </criteria>
      <criteria operator="AND" comment="system with pam_pwquality configured">
        <criteria operator="OR" comment="OSes with pwquality primarily used">
          <extend_definition comment="RHEL7 OS installed" definition_ref="installed_OS_is_rhel7" />
          <extend_definition comment="CentOS7 OS installed" definition_ref="installed_OS_is_centos7" />
          <extend_definition comment="Fedora OS installed" definition_ref="installed_OS_is_fedora" />
        </criteria>
        <criterion comment="pam_pwquality" test_ref="test_password_pam_pwquality_retry" />
      </criteria>
    </criteria>
  </definition>
  [...]
</def-group>
\end{lstlisting}
}

%\defverbatim[colored]\lstoscapd{
\defverbatim[colored]\lstovalt{
\begin{lstlisting}[language=xml]
<def-group>
  <definition class="compliance" id="accounts_password_pam_minclass" version="1">
  [...]
  </definition>
  <ind:textfilecontent54_test check="all"
  comment="check the configuration of /etc/security/pwquality.conf"
  id="test_password_pam_pwquality_minclass" version="1">
    <ind:object object_ref="obj_password_pam_pwquality_minclass" />
    <ind:state state_ref="state_password_pam_pwquality_minclass" />
  </ind:textfilecontent54_test>

  <ind:textfilecontent54_object id="obj_password_pam_pwquality_minclass"
  version="1">
    <ind:filepath>/etc/security/pwquality.conf</ind:filepath>
    <ind:pattern operation="pattern match">^minclass[\s]*=[\s]*(-?\d+)(?:[\s]|$)</ind:pattern>
    <ind:instance datatype="int" operation="less than or equal">1</ind:instance>
  </ind:textfilecontent54_object>

  <ind:textfilecontent54_state id="state_password_pam_pwquality_minclass"
  version="1">
    <ind:instance datatype="int">1</ind:instance>
    <ind:subexpression datatype="int" operation="greater than or equal"
    var_ref="var_password_pam_minclass" />
  </ind:textfilecontent54_state>

  <external_variable comment="External variable for pam_pwquality minclass"
  datatype="int" id="var_password_pam_minclass" version="1" />
</def-group>
\end{lstlisting}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Exemple simple de fiche OVAL}
  \lstoval
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Exemple fiche OVAL avec critères avancés}
  \lstovald
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Exemple de fiche OVAL avec sélecteur}
  \lstovalt
\end{frame}



\subsection{XCCDF: Ecrire une politique de sécurité dédiée}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
	\only<1>{
	\begin{block}{Principe d'une checklist XCCDF}
		\begin{itemize}
			\item Une checklist XCCDF permet de générer autant de STIGs que de profils définit dans la checklist
			\item une checklist au format XCCDF permet de valider la conformité d'une cible à un STIG donné
		\end{itemize}
	\end{block}
	}
	\only<2>{
	\begin{block}{une checklist XCCDF}
		\begin{itemize}
			\item A pour but de générer des STIGs et les checklist associées
			\item Inclut autant de profils que nécessaire, à partir du moment où l'ensemble des fiches et règles XCCDF les définissant sont présents
			\item Est composée de groupes, structurant les guides
			\item Chaque groupe contient une ou plusieurs règles
			\item Chaque règle se définie par
				\begin{itemize}
					\item Un titre
					\item Une description
					\item Un rationnel
					\item Une traçabilité à une ou plusieurs politiques, sous forme de références
					\item Un identifiant de configuration CCE associé (s'il existe)
					\item Une fiche OVAL décrivant la méthode de validation de la règle
				\end{itemize}
			\item On peut également y trouver des références OCIL au besoin
		\end{itemize}
	\end{block}
	}
\end{frame}

\subsection{Les profils et les politiques de sécurité}


\defverbatim[colored]\lstxccdf{
\begin{lstlisting}[language=xml]
<Group id="accounts-pam">
<title>Protect Accounts by Configuring PAM</title>
<description>Group introduction text</description>
<warning category="general">Potential group-wide warning infos
<weblink-macro link="http://url/toward/external-content#subchapter"/>
</warning>
[...]
<Value id="var_password_pam_minclass" type="number" operator="equals" interactive="0">
<title>minclass</title>
<description>Minimum number of categories of characters that must exist in a password</description>
<value selector="">3</value>
<value selector="1">1</value>
[...]
</Value>

<Rule id="accounts_password_pam_minclass" severity="medium" prodtype="rhel7">
<title>Set Password Strength Minimum Different Categories</title>
<description>The rule description...
</description>
<ocil clause="minclass is not found or not set equal to or greater than the required value">
OCIL informational when clause is true
</ocil>
<rationale>
Rule rationale explanation.
</rationale>
<ident prodtype="rhel7" cce="CCE-27115-5" />
<oval id="accounts_password_pam_minclass" value="var_password_pam_minclass"/>
<ref prodtype="rhel7" stigid="010170" />
<ref nist="IA-5" disa="195" ossrg="SRG-OS-000072-GPOS-00040" />
</Rule>
\end{lstlisting}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Exemple de checklist XCCDF}
  \lstxccdf
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
	\begin{block}{Définition d'un profil}
		Un profil correspond à la formalisation XCCDF d'un STIG.\\
		Elle correspond à:
		\begin{itemize}
			\item une suite de règles XCCDF
			\item un ensemble de sélecteurs, nécessaires pour spécialiser les règles\\
		\end{itemize}
	\end{block}
	Ainsi:
	\begin{itemize}
		\item le profil DAT-NT-28 niveau élevé est un sur-ensemble du profil DAT-NT-28 niveau restreint
		\item le profil PCI-DSS spécifie des sélecteurs pour diverses règles XCCDF comme la taille et la complexité des mots de passes
	\end{itemize}
\end{frame}

\defverbatim[colored]\lstprofile{
\begin{lstlisting}[language=xml]
<Profile id="pci-dss" xmlns="http://checklists.nist.gov/xccdf/1.1">
<title>PCI-DSS v3 Control Baseline for Red Hat Enterprise Linux 7</title>
<description>This is a *draft* profile for PCI-DSS v3.</description>

<refine-value idref="var_password_pam_unix_remember" selector="4" />
<refine-value idref="var_account_disable_post_pw_expiration" selector="90" />
<refine-value idref="var_accounts_passwords_pam_faillock_deny" selector="6" />
<refine-value idref="var_accounts_passwords_pam_faillock_unlock_time" selector="1800" />
<refine-value idref="sshd_idle_timeout_value" selector="15_minutes" />
<refine-value idref="var_password_pam_minlen" selector="7" />
<refine-value idref="var_password_pam_minclass" selector="2" />
<refine-value idref="var_accounts_maximum_age_login_defs" selector="90" />
<refine-value idref="var_auditd_num_logs" selector="5"/>

<select idref="service_auditd_enabled" selected="true"/>
<select idref="bootloader_audit_argument" selected="true"/>
<select idref="auditd_data_retention_num_logs" selected="true"/>
<select idref="auditd_data_retention_max_log_file" selected="true"/>
<select idref="auditd_data_retention_max_log_file_action" selected="true"/>
<select idref="auditd_data_retention_space_left_action" selected="true"/>
<select idref="auditd_data_retention_admin_space_left_action" selected="true"/>
<select idref="auditd_data_retention_action_mail_acct" selected="true"/>
<select idref="auditd_audispd_syslog_plugin_activated" selected="true"/>
[...]
<select idref="file_group_owner_grub2_cfg" selected="true"/>
<select idref="package_libreswan_installed" selected="true"/>

</Profile>
\end{lstlisting}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Exemple de profil}
  \lstprofile
\end{frame}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
\only<1>{
	\begin{block}{Dimentionnement}
		Dans les faits, la rédaction d'un STIG au format SCAP demande du temps.\\
		\begin{itemize}
			\item STIG PCI-DSS pour RHEL7: profil de 94 règles, 10 sélecteurs
			\item STIG DISA pour RHEL7: profil de 200 règles, 37 sélecteurs
			\item La complétude des checklists restent soumis à validation humaine
			\item Plus de 900 fiches OVAL pour RHEL7, plus de 250 pour Debian, etc.
		\end{itemize}
	\end{block}

	\begin{alertblock}{Charge de travail}
        Il ne faut pas sous-estimer la charge associée à la rédaction et au maintient d'un écosystème SCAP
        \begin{itemize}
          \item Les fiches OVAL sont globalement très nombreuses et évoluent avec les guides
          \item La rédaction des guides restera toujours un travail complexe, impliquant plusieurs expertises
        \end{itemize}
    \end{alertblock}
}
\only<2>{
	\begin{block}{Automatisation}
	\begin{itemize}
		\item La rédaction des checklist XCCDF peut difficilement être automatisé
		\item La génération de fiches OVAL est parfaitement automatisable
			\begin{itemize}
				\item Tests très redondants (présence d'une partition, droits d'un fichier/dossier)
				\item Peu de contenu descriptif (pas de rationale, etc.)
			\end{itemize}
		\item La grande majorité des fiches OVAL du SCAP-security-guide sont générées à partir de templates
	\end{itemize}
	\end{block}
}
\only<3>{
	\begin{block}{Répartition des rôles}
	\begin{itemize}
		\item Les fiches OVAL définissant un patch ou une vulnérabilité sont souvent à la charge de l'éditeur
        \item Elles sont souvent générées automatiquement en même temps que la CVE, ou à partir d'elle
	\end{itemize}
	\end{block}
}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 9/10 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Le workflow SCAP... reprise}
  \begin{center}
    \begin{figure}
      \includegraphics[height=5.5cm]{Images/scap/scap_automaton}
      \label{scap_workflow}
      \caption{Synthèse du workflow SCAP
      (\url{https://cve.mitre.org/docs/docs-2005/transformational_standards.html})}
    \end{figure}
  \end{center}

\end{frame}



\beginbackup



%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
\vspace{5mm}
\begin{center}
\frametitle{Questions ?}
\includegraphics[height=2.5cm]{Images/questions/linux_question}
\includegraphics[height=2.5cm]{Images/questions/mac_question}
\includegraphics[height=2.5cm]{Images/questions/windows_question}
\end{center}
\end{frame}


\section{Annexes}
\subsection{Acronymes}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame 4 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\rowcolors{2}{white}{lightgray}
\begin{frame}[t]
  \begin{center}
  \begin{tabular}{ll}
    \hline
    \textbf{Acronyme} & \textbf{Signification} \\
    \hline
    \hline
    ARF & Asset Reporting Format \\
    CCE & Common Configuration Enumeration \\
    CPE & Common Plateform Enumeration \\
    CVE & Common Vulnerability Discolsure \\
    CCSS & Common Configuration Scoring System \\
    CVSS & Common Vulnerability Scoring System \\
    CWE & Common Weakness Enumeration \\
    OCIL & Open Checklist Interactive Language \\
    OS & Operating System \\
    OVAL & Open Vulneratbility and Assessment Language \\
    STIG & Security Technical Implementation Guide \\
    TMSAD & Trust Model for Security Automation Data \\
    XCCDF & Extencible Configuration Checklist Description Format \\
  \end{tabular}
\end{center}
\end{frame}

\subsection{Table des références}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
  \frametitle{Sites web utiles}
  \begin{itemize}
    \item Cvedetails : \url{https://www.cvedetails.com}
    \item \label{pssie} PSSIE (Politique de Sécurité des Système d'Information de l'Etat)
      \url{https://www.ssi.gouv.fr/uploads/2014/11/pssie_anssi.pdf}
    \item \label{ppst} La PPST (Protection du Potentiel Scientifique et Technique) 
      \url{https://www.legifrance.gouv.fr/affichTexte.do?cidTexte=JORFTEXT000026140136&dateTexte=20170605}
    \item \label{cwe} Base des CWE du MITRE (\url{http://cwe.mitre.org})
    \item \label{scapref} \url{https://scap.nist.gov/revision/1.2/index.html} Spécifications de la dernière version finale du standard SCAP (1.2)
  \end{itemize}
\end{frame}

\subsection{Bibliographie et liens utiles}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[t]
%  \frametitle{Livres et articles sur Android et sa sécurité}
%  \begin{itemize}
%    \item Nikolay Elenkov,  {\it Android Security Internals: An In-Depth Guide to Android's
%      Security Architecture} - No starch press, 2015, ISBN : 978-1-59327-581-1
%    \item W. Confer \& W. Roberts, {\it Exploring SE for Android} - PACKT publishing, 2015,
%  ISBN: 978-1-78439-059-4
%\item André Moulu, {\it Sécurité des applications Android constructeurs et construction
%  de backdoors ciblées} - Actes du SSTIC 2013
%\item Nicolas Ruff, {\it Sécurité du système Android} - Actes du SSTIC 2011
%  \end{itemize}
\end{frame}

\backupend

\end{document}
